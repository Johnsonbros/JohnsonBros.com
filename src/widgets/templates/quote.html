<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="ui://widget/ui-kit.css">
  <link rel="stylesheet" href="ui://widget/shared-card.css">
</head>
<body class="widget-body">
  <div id="widget-root"></div>
  <script type="module">
    import { getToolOutput, notifyHeight } from "ui://widget/shared-card.js";

    const data = getToolOutput();
    const root = document.getElementById('widget-root');

    const service = data.service_type || data.service || 'Plumbing Service';
    const priceMin = data.price_range?.min || data.estimate_min || 99;
    const priceMax = data.price_range?.max || data.estimate_max || 500;
    const duration = data.estimated_duration || data.duration || '1-3 hours';
    const urgency = data.urgency || 'routine';

    const urgencyLabels = {
      routine: 'Routine',
      soon: 'Soon',
      urgent: 'Urgent',
      emergency: 'Emergency'
    };

    root.className = 'card card-accent-info';
    root.innerHTML = `
      <div class="card-header">
        <div class="icon-badge info">$</div>
        <div>
          <div class="card-title">Instant Estimate</div>
          <div class="card-subtitle">${service}</div>
        </div>
      </div>
      <div class="card-content">
        <div class="estimate-box">
          <div class="card-subtitle">Estimated Cost Range</div>
          <div class="estimate-range">$${priceMin} - $${priceMax}</div>
          <div class="card-subtitle">Final price depends on specific work needed</div>
        </div>
        <div class="detail-row">
          <span class="detail-label">Service</span>
          <span class="detail-value">${service}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Est. Duration</span>
          <span class="detail-value">${duration}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Priority</span>
          <span class="detail-value"><span class="badge warning">${urgencyLabels[urgency] || urgency}</span></span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Service Call</span>
          <span class="detail-value">$99 (waived if we do the work)</span>
        </div>
        <div class="pill-row">
          <span class="pill info">Transparent pricing</span>
          <span class="pill info">Licensed &amp; insured</span>
          <span class="pill info">Rated 4.9â˜…</span>
        </div>
      </div>
    `;

    notifyHeight(root);
  </script>
</body>
</html>
